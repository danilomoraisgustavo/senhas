<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PyDen Senhas - Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/dashboard.css" />
</head>

<body>
  <header class="topbar">
    <div class="topbar__inner">
      <div class="brand">
        <div class="brand__logo" aria-hidden="true">P</div>
        <div class="brand__text">
          <div class="brand__title">PyDen Senhas</div>
          <div class="brand__subtitle">Dashboard de atendimento</div>
        </div>
      </div>

      <nav class="nav">
        <button class="nav__item nav__item--active" data-view="chamar" type="button">Chamar</button>
        <button class="nav__item" data-view="gerar" type="button">Gerar</button>
        <button class="nav__item" data-view="cadastro" type="button">Cadastro manual</button>
        <button class="nav__item" data-view="banco" type="button">Banco</button>
        <a class="nav__link" href="/logout">Sair</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="card card--highlight">
      <div class="card__header">
        <div>
          <h1 class="card__title">Última senha chamada</h1>
          <p class="card__subtitle" id="lastCalledMeta">Aguardando chamadas…</p>
        </div>
        <div class="pill" id="lastCalledPill">—</div>
      </div>
      <div class="card__content">
        <div class="last-called">
          <div class="last-called__value" id="lastCalled">Nenhuma ainda</div>
          <div class="last-called__hint" id="lastCalledHint">Use os botões abaixo para chamar ou rechamar.</div>
        </div>
      </div>
    </section>

    <section class="grid">
      <section class="card view view--active" id="view-chamar">
        <div class="card__header">
          <h2 class="card__title">Chamar próxima senha</h2>
          <p class="card__subtitle">Escolha a fila (Estadual/Municipal) e o tipo (Normal/Prioridade).</p>
        </div>

        <div class="card__content">
          <div class="btn-grid">
            <button class="btn btn--primary" data-action="chamar" data-fila="E" data-tipo="N" type="button">
              Estadual • Normal
            </button>
            <button class="btn btn--primary" data-action="chamar" data-fila="E" data-tipo="P" type="button">
              Estadual • Prioridade
            </button>
            <button class="btn btn--primary" data-action="chamar" data-fila="M" data-tipo="N" type="button">
              Municipal • Normal
            </button>
            <button class="btn btn--primary" data-action="chamar" data-fila="M" data-tipo="P" type="button">
              Municipal • Prioridade
            </button>
          </div>

          <div class="divider"></div>

          <button class="btn btn--ghost" id="btnRechamar" type="button">Rechamar última senha</button>

          <div class="inline-alert inline-alert--info" id="chamarMsg" role="status" aria-live="polite"></div>
        </div>
      </section>

      <section class="card view" id="view-gerar">
        <div class="card__header">
          <h2 class="card__title">Gerar novas senhas</h2>
          <p class="card__subtitle">Gera a próxima senha automática por fila e prioridade.</p>
        </div>

        <div class="card__content">
          <div class="btn-grid">
            <button class="btn btn--secondary" data-action="gerar" data-fila="E" data-tipo="N" type="button">
              Gerar • Estadual • Normal
            </button>
            <button class="btn btn--secondary" data-action="gerar" data-fila="E" data-tipo="P" type="button">
              Gerar • Estadual • Prioridade
            </button>
            <button class="btn btn--secondary" data-action="gerar" data-fila="M" data-tipo="N" type="button">
              Gerar • Municipal • Normal
            </button>
            <button class="btn btn--secondary" data-action="gerar" data-fila="M" data-tipo="P" type="button">
              Gerar • Municipal • Prioridade
            </button>
          </div>

          <div class="divider"></div>

          <div class="stats" id="stats">
            <div class="stat">
              <div class="stat__label">Pendentes (Estadual • Normal)</div>
              <div class="stat__value" id="count-EN">—</div>
            </div>
            <div class="stat">
              <div class="stat__label">Pendentes (Estadual • Prioridade)</div>
              <div class="stat__value" id="count-EP">—</div>
            </div>
            <div class="stat">
              <div class="stat__label">Pendentes (Municipal • Normal)</div>
              <div class="stat__value" id="count-MN">—</div>
            </div>
            <div class="stat">
              <div class="stat__label">Pendentes (Municipal • Prioridade)</div>
              <div class="stat__value" id="count-MP">—</div>
            </div>
          </div>

          <div class="inline-alert inline-alert--success" id="gerarMsg" role="status" aria-live="polite"></div>
        </div>
      </section>

      <section class="card view" id="view-cadastro">
        <div class="card__header">
          <h2 class="card__title">Cadastro manual</h2>
          <p class="card__subtitle">Use apenas se você precisar lançar uma senha específica.</p>
        </div>

        <div class="card__content">
          <form id="formCadastroSenhas">
            <div class="form-row">
              <label for="fila">Fila</label>
              <select name="fila" id="fila" required>
                <option value="">Selecione</option>
                <option value="E">Estadual</option>
                <option value="M">Municipal</option>
              </select>
            </div>

            <div class="form-row">
              <label for="tipo">Tipo</label>
              <select name="tipo" id="tipo" required>
                <option value="">Selecione</option>
                <option value="N">Normal</option>
                <option value="P">Prioridade</option>
              </select>
            </div>

            <div class="form-row">
              <label for="numero">Número</label>
              <input type="number" name="numero" id="numero" min="1" step="1" placeholder="Ex: 25" required />
            </div>

            <button class="btn btn--primary" type="submit">Cadastrar</button>
          </form>

          <div class="inline-alert inline-alert--info" id="msgCadastro" role="status" aria-live="polite"></div>
        </div>
      </section>

      <section class="card view" id="view-banco">
        <div class="card__header">
          <h2 class="card__title">Banco de dados</h2>
          <p class="card__subtitle">Ações administrativas (cuidado).</p>
        </div>

        <div class="card__content">
          <div class="btn-grid">
            <button class="btn btn--danger" id="btnLimparSenhas" type="button">Limpar tabela de senhas</button>
          </div>

          <div class="inline-alert inline-alert--info" id="dbMessageContainer" role="status" aria-live="polite"></div>
        </div>
      </section>
    </section>
  </main>

  <script src="/socket.io/socket.io.js"></script>
  <script src="js/dashboard.js"></script>
</body>

</html>